import{useRef as n,useCallback as t,useState as r,useMemo as e}from"react";function o(){return o=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}return n},o.apply(this,arguments)}function i(){}var a=function(n,t){return function(r){return Math.max(n,Math.min(r,t))}};function u(n,t){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))}function f(n,t){for(var r=o({},t);n;)r.x-=n.offsetLeft,r.y-=n.offsetTop,n=n.offsetParent;return r}function c(c){var s,v,m,p=void 0===c?{}:c,y=p.enablePan,d=void 0===y||y,g=p.enableZoom,x=void 0===g||g,l=p.requireCtrlToZoom,h=void 0!==l&&l,P=p.disableWheel,M=void 0!==P&&P,z=p.panOnDrag,w=void 0===z||z,Y=p.preventClickOnPan,Z=void 0===Y||Y,E=p.zoomSensitivity,L=void 0===E?.01:E,X=p.minZoom,C=void 0===X?0:X,D=p.maxZoom,T=void 0===D?Infinity:D,b=p.minX,I=void 0===b?-Infinity:b,O=p.maxX,A=void 0===O?Infinity:O,H=p.minY,S=void 0===H?-Infinity:H,W=p.maxY,j=void 0===W?Infinity:W,k=p.initialZoom,q=void 0===k?1:k,K=p.initialPan,U=void 0===K?{x:0,y:0}:K,B=p.onPanStart,F=void 0===B?i:B,G=p.onPan,J=void 0===G?i:G,N=p.onPanEnd,Q=void 0===N?i:N,R=p.onZoom,V=void 0===R?i:R,$=n(null),_=(s=r(!1)[1],t(function(){s(function(n){return!n})},[])),nn=(v={wasPanning:!1,isPanning:!1,prevPointers:[],prevZoom:1,center:{x:0,y:0},transform:o({},U,{zoom:q})},m=n(v),[t(function(){return m.current},[]),t(function(n){return m.current="function"==typeof n?n(m.current):n,m.current},[])]),tn=nn[0],rn=nn[1],en=e(function(){return a(I,A)},[I,A]),on=e(function(){return a(S,j)},[S,j]),an=e(function(){return a(C,T)},[C,T]),un=t(function(n){var t=$.current,r=tn();return t&&(r.transform="function"==typeof n?n(r.transform):n,r.center.x=(t.offsetWidth/2-r.transform.x)/r.transform.zoom,r.center.y=(t.offsetHeight/2-r.transform.y)/r.transform.zoom,rn(r),_()),r.transform},[tn,rn,_]),fn=t(function(n){return un(function(t){var r=t.zoom,e="function"==typeof n?n({x:t.x,y:t.y}):n;return{x:en(e.x),y:on(e.y),zoom:r}})},[en,on,un]),cn=t(function(n,t){var r=$.current;r&&un(function(e){var o=e.x,i=e.y,a=e.zoom,u=an("function"==typeof n?n(a):n),f=t?{x:t.x-r.offsetWidth/2,y:t.y-r.offsetHeight/2}:{x:0,y:0};return{x:en(o+(f.x-o)*(a-u)/a),y:on(i+(f.y-i)*(a-u)/a),zoom:u}})},[en,on,an,un]),sn=t(function(n){if(d){var t=tn();t.prevPointers=n,t.isPanning=!0,rn(t),F(n,t.transform)}},[d,F,rn,tn]),vn=t(function(n){var t=tn();if(t.isPanning){t.wasPanning=!0;var r=t.prevPointers;t.prevPointers=n,rn(t);for(var e=0,o=0,i=Math.min(n.length,r.length,2),a=0;a<i;a++)e+=n[a].x-r[a].x,o+=n[a].y-r[a].y;e/=i,o/=i;var f=2===i?u(n[0],n[1])/u(r[0],r[1]):1;fn(function(n){return{x:n.x+e,y:n.y+o}}),cn(function(n){return n*f}),_(),J(n,tn().transform)}},[J,fn,cn,tn,rn,_]),mn=t(function(){tn().isPanning&&(rn(function(n){return o({},n,{isPanning:!1})}),Q())},[Q,tn,rn]),pn=t(function(n){var t=tn();Z&&t.wasPanning&&(rn(function(n){return o({},n,{wasPanning:!1})}),n.stopPropagation())},[Z,tn,rn]),yn=t(function(n){if(x&&$.current)if(n.preventDefault(),!h||n.ctrlKey){var t=f($.current,{x:n.pageX,y:n.pageY}),r=n.deltaY;1===n.deltaMode&&(r*=15),cn(function(n){return n*Math.pow(1-L,r)},t),V(tn().transform)}else fn(function(t){return{x:t.x-n.deltaX,y:t.y-n.deltaY}})},[x,h,L,V,fn,cn,tn]),dn=t(function(n){n.preventDefault(),rn(function(n){return o({},n,{prevZoom:n.transform.zoom})})},[rn]),gn=t(function(n){n.preventDefault();var t=f($.current,{x:n.pageX,y:n.pageY});cn(tn().prevZoom*n.scale,t),V(tn().transform)},[cn,V,tn]),xn=t(function(n){if(n)M||n.addEventListener("wheel",yn),n.addEventListener("gesturestart",dn),n.addEventListener("gesturechange",gn),n.addEventListener("gestureend",gn);else if($.current)return function(){var n=$.current;n&&(M||n.removeEventListener("wheel",yn),n.removeEventListener("gesturestart",dn),n.removeEventListener("gesturechange",gn),n.removeEventListener("gestureend",gn))};$.current=n},[yn,dn,gn,M]),ln=t(function(n){return sn(Array.from(n.touches).map(function(n){return{x:n.pageX,y:n.pageY}}))},[sn]),hn=t(function(n){return vn(Array.from(n.touches).map(function(n){return{x:n.pageX,y:n.pageY}}))},[vn]),Pn=t(function(n){0===n.touches.length?mn():sn(Array.from(n.touches).map(function(n){return{x:n.pageX,y:n.pageY}}))},[mn,sn]),Mn=t(function(n){return sn([{x:n.pageX,y:n.pageY}])},[sn]),zn=t(function(n){return vn([{x:n.pageX,y:n.pageY}])},[vn]),wn=tn();return{container:$.current,setContainer:xn,transform:"translate3D("+wn.transform.x+"px, "+wn.transform.y+"px, 0) scale("+wn.transform.zoom+")",center:wn.center,pan:{x:wn.transform.x,y:wn.transform.y},zoom:wn.transform.zoom,setPan:fn,setZoom:cn,panZoomHandlers:w?{onTouchStart:ln,onTouchMove:hn,onTouchEnd:Pn,onTouchCancel:Pn,onMouseDown:Mn,onMouseMove:zn,onMouseUp:mn,onMouseLeave:mn,onClickCapture:pn}:{}}}export{c as default};
//# sourceMappingURL=index.module.js.map
